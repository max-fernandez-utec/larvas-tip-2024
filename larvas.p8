pico-8 cartridge // http://www.pico-8.com
version 42
__lua__
-- larvas
-- copyleft 2024 - tip

--[[
  larvas (un demake de worms)
  copyright 2024
  by taller de videojuegos tip 2024
  is licensed under cc by-nc 4.0
]]

function _init()
	x,y,dx,dy=63,63,0,0
	
	ang,vel=0,2
	
	jug=make_larva()
	jug.x=55
	jug.y=55
end

function _update()
	if (btn(⬆️)) jug.a=min(jug.a+0.01,1/4)
	if (btn(⬇️)) jug.a=max(jug.a-0.01,-1/4)
		
	dx=vel * cos(ang)
	dy=vel * sin(ang)

	x+=dx
	y+=dy
	
	if (x > 128+5) then
		x = -5
	end
	
	if (x < -5) then
		x = 128+5
	end
	
	if (y > 128+5) then
		y = -5
	end
	
	if (y < -5) then
		y = 128+5
	end
	
	jug.upd()
end

function _draw()
	cls()
	
	-- parte del frente
	jug.drw()
	
	-- circfill(x,y,5,8)
	print("a="..jug.a)
end


-->8
-- entidades
function make_entity()
	local e={}
	e.x=0
	e.y=0
	e.s=0
	e.dx=0
	e.dy=0
	
	return e
end

function make_larva()
	local e=make_entity()
	e.s=1
	e.fh=true
	e.a=0
	
	e.upd=function()
		if (btn(➡️)) e.fh=true
		if (btn(⬅️)) e.fh=false
	end
	
	e.drw=function()
		
	
		-- dibujar cuerpo
		spr(e.s,
			e.x+(e.fh and 8 or 0),
			e.y,1,2,
			e.fh)
	
		-- dibujar cola
		spr(e.s+17,
			e.x+(e.fh and 0 or 8),
			e.y+8,
			1,1,
			e.fh)
			
		-- dibujar mira
		-- centro en (5,11)
		spr(e.s+1,
			e.x+(e.fh and 24 or -16),
			e.y+5)
	end
	
	return e
end
__gfx__
00000000000000000066600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000004444000606060000444400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0070070004ffff406000006004ffff40000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000770004777fff4660006604777fff4000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0007700040707fff6000006040707fff000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0070070040707fff0606060040707fff000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000007777fff0066600007777fff000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000004fffff00000000004fffff000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000004fffff40000000004fffff4000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000444fff4000000000444fff4000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000004fffff44400000004fffff444000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000004ffffffff40000004ffffffff400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000004ffffffff40000004ffffffff400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000004fffffffff4000004fffffffff40000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000004ffff44fff4000004ffff44fff4000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000044440044400000004444004440000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
